

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Preparing electrostatic force field &mdash; QuickFF 2.2.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> QuickFF
          

          
            
            <img src="../_static/quickff_logo_trans_small.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../papers.html">QuickFF literature</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ig.html">Installation Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ig.html#dependencies">Dependencies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ig.html#molmod-dependency">MolMod dependency</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ig.html#yaff-dependency">Yaff dependency</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ig.html#external-dependencies">External dependencies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ig.html#downloading-quickff">Downloading QuickFF</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ig.html#stable-release">Stable release</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ig.html#latest-development-version-experts-only">Latest development version (experts only)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ig.html#installing-quickff">Installing QuickFF</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ug.html">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ug.html#quickff-settings">QuickFF Settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ug.html#settings-description">Settings description</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../ug.html#general-settings">General settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ug.html#input-output-settings">Input/output settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ug.html#reference-force-field-contribution-settings">Reference force field contribution settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ug.html#force-field-expression-settings">Force field expression settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ug.html#fitting-algorithm-settings">Fitting algorithm settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ug.html#default-settings">Default settings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ug.html#preparing-electrostatic-force-field">Preparing electrostatic force field</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ug.html#quickff-main-script-qff-py">QuickFF main script qff.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ug.html#mandatory-input-files">Mandatory input files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ug.html#optional-input-files">Optional input files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ug.html#automatic-estimation-of-atom-types">Automatic estimation of atom types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ug.html#miscellanous-options">Miscellanous options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ug.html#output">Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ug.html#logging">Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ug.html#parallel-quickff">Parallel QuickFF</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ug.html#importing-quickff-as-a-library">Importing QuickFF as a library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ug.html#define-the-system">Define the system</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ug.html#define-the-ab-initio-reference">Define the ab initio reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ug.html#define-force-field-reference-objects">Define force field reference objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ug.html#define-the-program-and-run-it">Define the program and run it</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ug.html#id3">Logging</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tu.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tu.html#tutorial-1-benzene">Tutorial 1 - Benzene</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tu.html#covalent-force-field-without-non-bonding-terms">Covalent force field without non-bonding terms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tu.html#force-field-with-electrostatics">Force field with electrostatics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tu.html#tutorial-2-water">Tutorial 2 - Water</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tu.html#tutorial-3-biphenyl">Tutorial 3 - Biphenyl</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vl.html">Validation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../vl.html#validation-methodology">Validation methodology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vl.html#validation-1-water">Validation 1 - Water</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../vl.html#force-field-construction">Force field construction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vl.html#force-field-evaluation">Force field evaluation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../vl.html#perturbation-trajectories">Perturbation trajectories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vl.html#geometry-and-frequencies">Geometry and frequencies</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../vl.html#validation-2-benzene">Validation 2 - Benzene</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../vl.html#id1">Force field construction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vl.html#id2">Force field evaluation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../vl.html#id3">Perturbation trajectories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vl.html#id4">Geometry and frequencies</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rg.html">Reference Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../rg.html#modules">Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../rg.html#module-quickff.cost"><code class="docutils literal"><span class="pre">quickff.cost</span></code> – Least-Square cost function for hessian matching</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rg.html#module-quickff.io"><code class="docutils literal"><span class="pre">quickff.io</span></code> – Input/Ouput methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rg.html#module-quickff.settings"><code class="docutils literal"><span class="pre">quickff.settings</span></code> – QuickFF configuration settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rg.html#module-quickff.perturbation"><code class="docutils literal"><span class="pre">quickff.perturbation</span></code> – Perturbation trajectories for internal coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rg.html#module-quickff.program"><code class="docutils literal"><span class="pre">quickff.program</span></code> – Program classes implementing a sequence of fitting steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rg.html#module-quickff.reference"><code class="docutils literal"><span class="pre">quickff.reference</span></code> – Representation of the ab initio reference data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rg.html#module-quickff.tools"><code class="docutils literal"><span class="pre">quickff.tools</span></code> – Various convenient tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rg.html#module-quickff.valence"><code class="docutils literal"><span class="pre">quickff.valence</span></code> – ValenceFF class storing all valence ff terms</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../rg.html#scripts">Scripts</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QuickFF</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Preparing electrostatic force field</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/trash/ug_inputei.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="preparing-electrostatic-force-field">
<span id="seclab-ug-tools-inputei"></span><span id="seclab-ug-tools"></span><h1>Preparing electrostatic force field<a class="headerlink" href="#preparing-electrostatic-force-field" title="Permalink to this headline">¶</a></h1>
<p>A Yaff force field file for the electrostatic contribution can be constructed
from the output of <a class="reference external" href="https://theochem.github.io/horton/">HORTON</a> using the
<a class="reference internal" href="rg_scripts.html#seclab-rg-scripts-inputei"><span class="std std-ref">qff-input-ei.py</span></a> script:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">qff</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="n">ei</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="n">options</span><span class="p">]</span> <span class="n">fn_sys</span> <span class="n">fn_wpart</span><span class="p">:</span><span class="n">path</span>
</pre></div>
</div>
<p><strong>Arguments</strong></p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">fn_sys</span></code></dt>
<dd>a file containing the system information. Any file type accepted by the
main script <a class="reference internal" href="rg_scripts.html#seclab-rg-scripts-qff"><span class="std std-ref">qff.py</span></a> is also accepted here
(see <a class="reference internal" href="../ug.html#seclab-inputfiles"><span class="std std-ref">input files</span></a>).</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">fn_wpart</span></code></dt>
<dd>is a <a class="reference external" href="https://theochem.github.io/horton/">HORTON</a>: HDF5 file containing
the charges of each atom. The script <code class="docutils literal"><span class="pre">horton-wpart.py</span></code> derives atomic charges from
wavefunction files and writes the results in this type of HDF5 file. The charges in
this file should have the same ordering as the atoms in the system file <code class="docutils literal"><span class="pre">fn_sys</span></code>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">path</span></code></dt>
<dd>is the path in the HDF5 to the dataset <code class="docutils literal"><span class="pre">charges</span></code>. The default path in HORTON 2.x
is <code class="docutils literal"><span class="pre">/charges</span></code>. In HORTON 1.x, the path depends on the method used to compute the
charges, e.g. <code class="docutils literal"><span class="pre">/wpart/hi/charges</span></code> would be the path to the Hirshfeld-I charges.</dd>
</dl>
</li>
</ul>
<p><strong>Options</strong></p>
<ul class="simple">
<li><dl class="first docutils">
<dt>Force field atom types (<code class="xref std std-option docutils literal"><span class="pre">--ffatypes=LEVEL</span></code>):</dt>
<dd>Determine the force field atom types according to the given level (see
<a class="reference internal" href="../ug.html#seclab-ug-atype-estimator"><span class="std std-ref">automatic estimation of atom types</span></a>). By
default, the atom types are assumed to be defined in <code class="docutils literal"><span class="pre">fn_sys</span></code>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Gaussian distributed charges (<code class="xref std std-option docutils literal"><span class="pre">--gaussian</span></code>):</dt>
<dd>Treat the atomic charges as Gaussian charge distributions with atomic radii
determined according to the precedure of
<a class="reference external" href="http://www.sciencedirect.com/science/article/pii/S0009261407002618">Chen et al.</a>,
implemented in the routine <code class="docutils literal"><span class="pre">get_ei_radii</span></code> from the
<a class="reference internal" href="rg_module.html#seclab-rg-modules-tools"><span class="std std-ref">tools</span></a> module.</dd>
</dl>
</li>
</ul>
<p><strong>Remarks</strong></p>
<p>All electrostatic interactions will be included in the force field, i.e. no
scaling is applied. This means that atoms that are connected to each other 1, 2
or 3 bonds will also interact electrostatically. To change this behaviour, open
the resulting Yaff parameter file after applying this script, and change the
corresponding scales in the file. For example: <cite>FIXQ:SCALE 1 0.0</cite> will turn of
electrostatic interactions for bonded atoms. See also the
<a class="reference external" href="http://molmod.github.io/yaff/ug_forcefield.html#prefix-fixq">Yaff page</a> on
the parameter file for electrostatic interactions.</p>
<p>The script might print a WARNING to the screen indicating the for a certain atom
type the standard deviation of the charges for this atom type is rather high.
This could indicate that the current atom types are to general, i.e. not
specific enough for the current chemical configuration. A higher level of atom
type specification might then be adequate.</p>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Louis Vanduyfhuys, Center for Molecular Modeling, Ghent University

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'2.2.1',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>
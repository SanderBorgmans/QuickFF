
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Tutorial 1 - Benzene &#8212; QuickFF 2.1.3 documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.1.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">QuickFF 2.1.3 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tutorial-1-benzene">
<h1>Tutorial 1 - Benzene<a class="headerlink" href="#tutorial-1-benzene" title="Permalink to this headline">¶</a></h1>
<p>This tutorial will describe in detail the use of QuickFF by means of the command
line scripts, to generate a force field for benzene. This tutorial assumes that
the following input files are available (examples of such file are provided with
the source code in the directory <cite>share/systems/benzene</cite>):</p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">gaussian.fchk</span></code></dt>
<dd><p class="first">A Gaussian Formatted Checkpoint file containing the ab initio equilibrium
geometry and ab initio Hessian in equilibrium. This file can be generated
by performing a freq job in Gaussian using your level of theory and basis
set of choice. The following line should be added prior to the route
section (i.e. the lines starting with #):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">chk</span><span class="o">=</span><span class="n">gaussian</span><span class="o">.</span><span class="n">chk</span>
</pre></div>
</div>
<p>When the calculation terminated succesfully, make the fchk file using the
following command:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="n">formchk</span> <span class="n">gaussian</span><span class="o">.</span><span class="n">chk</span> <span class="n">gaussian</span><span class="o">.</span><span class="n">fchk</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">gaussian_mbis.h5</span></code></dt>
<dd><p class="first">A HDF5 file containing the atomic charges. Such a file can, for example, be
generated using <a class="reference external" href="http://molmod.github.com/horton/">HORTON</a>. If you have HORTON 2.x
installed, the following command will derive the atomic charges in this example from
the wavefunction in the <code class="docutils literal"><span class="pre">gaussian.fchk</span></code> file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">horton</span><span class="o">-</span><span class="n">wpart</span><span class="o">.</span><span class="n">py</span> <span class="n">gaussian</span><span class="o">.</span><span class="n">fchk</span> <span class="n">gaussian_mbis</span><span class="o">.</span><span class="n">h5</span> <span class="n">mbis</span> <span class="o">--</span><span class="n">grid</span><span class="o">=</span><span class="n">ultrafine</span>
</pre></div>
</div>
<p>To determine
the path in the HDF5 file to these charges, one can use the <cite>h5dump</cite>
command (part of the Linux package <cite>hdf5-tools</cite>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">h5dump</span> <span class="o">-</span><span class="n">n</span> <span class="n">gaussian_mbis</span><span class="o">.</span><span class="n">h5</span>
</pre></div>
</div>
<p>The output of this command for the gaussian_mbis.h5 file provided in the
directory <code class="docutils literal"><span class="pre">share/tuturials/benzene</span></code> is:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">/home/louis/build/quickff/doc/trash/tu_benzene.rst</tt>, line 40)</p>
<p>Command 'h5dump -n gaussian_mbis.h5' failed: [Errno 2] No such file or directory: '/home/louis/build/quickff/doc/share/tutorials/benzene': '/home/louis/build/quickff/doc/share/tutorials/benzene'</p>
</div>
<p class="last">From this output, we can conclude that, for this example, MBIS charges can
be found in the path <code class="docutils literal"><span class="pre">/charges</span></code>.</p>
</dd>
</dl>
</li>
</ul>
<div class="section" id="covalent-force-field-without-non-bonding-terms">
<h2>Covalent force field without non-bonding terms<a class="headerlink" href="#covalent-force-field-without-non-bonding-terms" title="Permalink to this headline">¶</a></h2>
<p>As a first example, we will derive a force field containing only covalent terms.
No electrostatic nor van der Waals interactions will be included in the force
field. Furthermore, we use the <a class="reference internal" href="../ug_script.html#seclab-ug-atype-estimator"><span class="std std-ref">built-in feature</span></a> to automatically determine atom types according to
the level <cite>low</cite> (for benzene it does not make any difference which level is
chosen). This can very easily be done using the <a class="reference internal" href="rg_scripts.html#seclab-rg-scripts-qff"><span class="std std-ref">qff.py</span></a> script (documentation on the available options can be
accessed by <cite>qff.py</cite> <code class="xref std std-option docutils literal"><span class="pre">--help</span></code>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">qff</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">ffatypes</span><span class="o">=</span><span class="n">low</span> <span class="o">--</span><span class="n">suffix</span><span class="o">=</span><span class="n">_noei</span> <span class="n">gaussian</span><span class="o">.</span><span class="n">fchk</span>
</pre></div>
</div>
<p>The script will dump all relevant information to the screen, for this tutorial,
the output is as follows:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">/home/louis/build/quickff/doc/trash/tu_benzene.rst</tt>, line 64)</p>
Command 'qff.py --ffatypes=low --suffix=_noei gaussian.fchk' failed: [Errno 2] No such file or directory: '/home/louis/build/quickff/doc/share/tutorials/benzene': '/home/louis/build/quickff/doc/share/tutorials/benzene'</div>
<p>The logger will dump to following information to the screen (or a file if the
<code class="xref std std-option docutils literal"><span class="pre">--logfile</span></code> option was used):</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>Machine environment:</dt>
<dd>This section contains some general information about the machine environment
on which you ran the quickff job. It contains the user name, machine info,
starting time of job, Python version, Numpy version, Scipy versoin,
Matplotlib version, current directory and the command used
to envoke quickff.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Routine sequence:</dt>
<dd>Every task that is performed will be shown in the log output. For example,
the line <code class="docutils literal"><span class="pre">PTGEN</span>&#160; <span class="pre">Constructing</span> <span class="pre">trajectories</span></code> indicates that QuickFF is
busy constructing the perturbation trajectories. As a second example, the
line <code class="docutils literal"><span class="pre">HCEST</span>&#160; <span class="pre">Estimating</span> <span class="pre">force</span> <span class="pre">constants</span> <span class="pre">from</span> <span class="pre">Hessian</span> <span class="pre">cost</span> <span class="pre">for</span> <span class="pre">tasks</span>
<span class="pre">HC_FC_DIAG</span> <span class="pre">HC_FC_CROSS</span></code> indicates QuickFF is estimating force constants by
means of a least-square fit of the FF Hessian to the AI Hessian for each
term for which the task <cite>HC_FC_DIAG</cite> and <cite>HC_FC_CROSS</cite> was selected.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Final force field parameters:</dt>
<dd>The final FF parameters are shown at the end of the log output.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Timings:</dt>
<dd>Finally, a summary of the timings for several steps during run of the
program is provided.</dd>
</dl>
</li>
</ul>
<p>The force field parameters were also written to the Yaff parameters file
<cite>pars_yaff_noei.txt</cite>:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">/home/louis/build/quickff/doc/trash/tu_benzene.rst</tt>, line 96)</p>
Command 'cat pars_yaff_noei.txt' failed: [Errno 2] No such file or directory: '/home/louis/build/quickff/doc/share/tutorials/benzene': '/home/louis/build/quickff/doc/share/tutorials/benzene'</div>
</div>
<div class="section" id="force-field-with-electrostatics">
<h2>Force field with electrostatics<a class="headerlink" href="#force-field-with-electrostatics" title="Permalink to this headline">¶</a></h2>
<ul>
<li><dl class="first docutils">
<dt>Generating Yaff input</dt>
<dd><p class="first">First we need to generate the Yaff input file for the electrostatic
contribution to the force field. This is done using the script
<a class="reference internal" href="rg_scripts.html#seclab-rg-scripts-inputei"><span class="std std-ref">qff_input-ei.py</span></a>. For this tutorial,
we will convert the charges given in the dataset <code class="docutils literal"><span class="pre">/charges</span></code> of the
file <code class="docutils literal"><span class="pre">gaussian_mbis.h5</span></code> for the atoms in gaussian.fchk with atom types
according to the level <cite>medium</cite> and use Gaussian charge distributions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">qff</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="n">ei</span><span class="o">.</span><span class="n">py</span>  <span class="o">-</span><span class="n">v</span><span class="o">--</span><span class="n">ffatypes</span><span class="o">=</span><span class="n">low</span> <span class="o">--</span><span class="n">gaussian</span> <span class="n">gaussian</span><span class="o">.</span><span class="n">fchk</span> <span class="n">gaussian_mbis</span><span class="o">.</span><span class="n">h5</span><span class="p">:</span><span class="n">charges</span> <span class="n">pars_ei_mbisgauss</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>This command dumped the following output to the screen, indicating wheter or
not the atom types are well chosen from the point of view of electrostatics
(see second remark in <a class="reference internal" href="../ug_inputei.html#seclab-ug-tools-inputei"><span class="std std-ref">qff-input-ei.py</span></a>):</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">/home/louis/build/quickff/doc/trash/tu_benzene.rst</tt>, line 117)</p>
<p>Command 'qff-input-ei.py -v --ffatypes=low --gaussian gaussian.fchk gaussian_mbis.h5:charges pars_ei_mbisgauss.txt' failed: [Errno 2] No such file or directory: '/home/louis/build/quickff/doc/share/tutorials/benzene': '/home/louis/build/quickff/doc/share/tutorials/benzene'</p>
</div>
<p>Furthermore, the following Yaff parameter (<cite>pars_ei.txt</cite>) file was written:</p>
<div class="last system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">/home/louis/build/quickff/doc/trash/tu_benzene.rst</tt>, line 122)</p>
<p>Command 'cat pars_ei_mbisgauss.txt' failed: [Errno 2] No such file or directory: '/home/louis/build/quickff/doc/share/tutorials/benzene': '/home/louis/build/quickff/doc/share/tutorials/benzene'</p>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Constructing the covalent contribution</dt>
<dd><p class="first">Now, we generate a covalent force field on top of the previously derived
electrostatic contribution using the qff.py script:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">qff</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">ffatype</span><span class="o">=</span><span class="n">low</span> <span class="o">--</span><span class="n">ei</span><span class="o">=</span><span class="n">pars_ei_mbisgauss</span><span class="o">.</span><span class="n">txt</span> <span class="o">--</span><span class="n">suffix</span><span class="o">=</span><span class="n">_mbisgauss</span> <span class="n">gaussian</span><span class="o">.</span><span class="n">fchk</span>
</pre></div>
</div>
<p>The logging output for this job is:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">/home/louis/build/quickff/doc/trash/tu_benzene.rst</tt>, line 133)</p>
<p>Command 'qff.py --ffatypes=low --ei=pars_ei_mbisgauss.txt --suffix=_mbisgauss gaussian.fchk' failed: [Errno 2] No such file or directory: '/home/louis/build/quickff/doc/share/tutorials/benzene': '/home/louis/build/quickff/doc/share/tutorials/benzene'</p>
</div>
<p>An extra line appeared in the beginning of the log output, i.e.
<code class="docutils literal"><span class="pre">QFF</span>&#160;&#160;&#160; <span class="pre">Initializing</span> <span class="pre">Yaff</span> <span class="pre">force</span> <span class="pre">field</span> <span class="pre">reference</span> <span class="pre">for</span> <span class="pre">EI</span></code>. This indicates
that an extra reference instance was created to represent the EI
contribution to the force field. Furthermore, the covalent parameters are
almost identical compared to the FF without electrostatics. This is indeed
what we expect due to the charges being so small.</p>
<p>The force field parameters were also written to the Yaff parameters file
<cite>pars_yaff_mbisgauss.txt</cite>:</p>
<div class="last system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">/home/louis/build/quickff/doc/trash/tu_benzene.rst</tt>, line 146)</p>
<p>Command 'cat pars_yaff_mbisgauss.txt' failed: [Errno 2] No such file or directory: '/home/louis/build/quickff/doc/share/tutorials/benzene': '/home/louis/build/quickff/doc/share/tutorials/benzene'</p>
</div>
</dd>
</dl>
</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorial 1 - Benzene</a><ul>
<li><a class="reference internal" href="#covalent-force-field-without-non-bonding-terms">Covalent force field without non-bonding terms</a></li>
<li><a class="reference internal" href="#force-field-with-electrostatics">Force field with electrostatics</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/trash/tu_benzene.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">QuickFF 2.1.3 documentation</a> &#187;</li> 
      </ul>
    </div>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>
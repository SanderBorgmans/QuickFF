<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tutorial 1 - Benzene &mdash; QuickFF 2.1.3 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.1.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="QuickFF 2.1.3 documentation" href="index.html" />
    <link rel="next" title="Tutorial 2 - Water" href="tu_water.html" />
    <link rel="prev" title="3. Generating Yaff parameter file for the electrostatic contribution" href="ug_inputei.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tu_water.html" title="Tutorial 2 - Water"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ug_inputei.html" title="3. Generating Yaff parameter file for the electrostatic contribution"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">QuickFF 2.1.3 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tutorial-1-benzene">
<h1>Tutorial 1 - Benzene<a class="headerlink" href="#tutorial-1-benzene" title="Permalink to this headline">¶</a></h1>
<p>This tutorial will describe in detail the use of QuickFF by means of the command
line scripts, to generate a force field for benzene. This tutorial assumes that
the following input files are available (examples of such file are provided with
the source code in the directory <cite>share/systems/benzene</cite>):</p>
<ul>
<li><dl class="first docutils">
<dt>gaussian.fchk</dt>
<dd><p class="first">A Gaussian Formatted Checkpoint file containing the ab initio equilibrium
geometry and ab initio Hessian in equilibrium. This file can be generated
by performing a freq job in Gaussian using your level of theory and basis
set of choice. The following line should be added prior to the route
section (i.e. the lines starting with #):</p>
<div class="highlight-python"><div class="highlight"><pre>%chk=gaussian.chk
</pre></div>
</div>
<p>When the calculation terminated succesfully, make the fchk file using the
following command:</p>
<div class="last highlight-python"><div class="highlight"><pre>formchk gaussian.chk gaussian.fchk
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>gaussian_wpart.h5</dt>
<dd><p class="first">A HDF5 file containing the atomic charges. Such a file can, for example, be
generated using <a class="reference external" href="http://molmod.github.com/horton/">Horton</a>. To determine
the path in the HDF5 file to these charges, one can use the <cite>h5dump</cite>
command (part of the Linux package <cite>hdf5-tools</cite>):</p>
<div class="highlight-python"><div class="highlight"><pre>h5dump -n gaussian_wpart.h5
</pre></div>
</div>
<p>The output of this command for the gaussian_wpart.h5 file provided in the
directory <cite>share/systems/benzene</cite> is:</p>
<div class="highlight-text"><div class="highlight"><pre>HDF5 &quot;/home/louis/build/quickff/share/systems/benzene/gaussian_wpart.h5&quot; {
FILE_CONTENTS {
 group      /
 group      /system
 dataset    /system/coordinates
 group      /system/extra
 dataset    /system/extra/energy
 dataset    /system/extra/mulliken_charges
 dataset    /system/numbers
 group      /system/obasis
 dataset    /system/obasis/alphas
 dataset    /system/obasis/centers
 dataset    /system/obasis/con_coeffs
 dataset    /system/obasis/nprims
 dataset    /system/obasis/shell_map
 dataset    /system/obasis/shell_types
 dataset    /system/pseudo_numbers
 group      /system/wfn
 group      /system/wfn/dm_alpha
 dataset    /system/wfn/dm_alpha/array
 group      /system/wfn/exp_alpha
 dataset    /system/wfn/exp_alpha/coeffs
 dataset    /system/wfn/exp_alpha/energies
 dataset    /system/wfn/exp_alpha/occupations
 dataset    /system/wfn/nbasis
 dataset    /system/wfn/norb
 group      /system/wfn/occ_model
 dataset    /system/wfn/occ_model/nalpha
 dataset    /system/wfn/occ_model/nbeta
 group      /wpart
 group      /wpart/h
 dataset    /wpart/h/c6s
 dataset    /wpart/h/cartesian_multipoles
 dataset    /wpart/h/charges
 dataset    /wpart/h/populations
 dataset    /wpart/h/pseudo_populations
 dataset    /wpart/h/radial_moments
 dataset    /wpart/h/volume_ratios
 dataset    /wpart/h/volumes
 group      /wpart/he
 dataset    /wpart/he/c6s
 dataset    /wpart/he/cartesian_multipoles
 dataset    /wpart/he/change
 dataset    /wpart/he/charges
 dataset    /wpart/he/history_charges
 dataset    /wpart/he/history_propars
 dataset    /wpart/he/niter
 dataset    /wpart/he/populations
 dataset    /wpart/he/pseudo_populations
 dataset    /wpart/he/radial_moments
 dataset    /wpart/he/volume_ratios
 dataset    /wpart/he/volumes
 group      /wpart/hi
 dataset    /wpart/hi/c6s
 dataset    /wpart/hi/cartesian_multipoles
 dataset    /wpart/hi/change
 dataset    /wpart/hi/charges
 dataset    /wpart/hi/history_charges
 dataset    /wpart/hi/history_propars
 dataset    /wpart/hi/niter
 dataset    /wpart/hi/populations
 dataset    /wpart/hi/pseudo_populations
 dataset    /wpart/hi/radial_moments
 dataset    /wpart/hi/volume_ratios
 dataset    /wpart/hi/volumes
 }
}
</pre></div>
</div>
<p class="last">From this output, we can conclude that, for example, Hirshfeld-I charges can
be found in the path <cite>/wpart/hi/charges</cite>.</p>
</dd>
</dl>
</li>
</ul>
<div class="section" id="covalent-force-field-without-non-bonding-terms">
<h2>Covalent force field without non-bonding terms<a class="headerlink" href="#covalent-force-field-without-non-bonding-terms" title="Permalink to this headline">¶</a></h2>
<p>As a first example, we will derive a force field containing only covalent terms.
No electrostatic nor van der Waals interactions will be included in the force
field. Furthermore, we use the <a class="reference internal" href="ug_script.html#seclab-ug-atype-estimator"><em>built-in feature</em></a> to automatically determine atom types according to
the level <cite>low</cite> (for benzene it does not make any difference which level is
chosen). This can very easily be done using the <a class="reference internal" href="rg_scripts.html#seclab-rg-scripts-qff"><em>qff.py</em></a> script (documentation on the available options can be
accessed by <cite>qff.py</cite> <em class="xref std std-option">--help</em>):</p>
<div class="highlight-python"><div class="highlight"><pre>qff.py --ffatypes=low gaussian.fchk
</pre></div>
</div>
<p>The script will dump all relevant information to the screen, for this tutorial,
the output is as follows:</p>
<div class="highlight-text"><div class="highlight"><pre>________________/\\\_________/\\\\\\\\\\\\\\\__/\\\\\\\\\\\\\\\_________________
______________/\\\\/\\\\_____\/\\\///////////__\/\\\///////////_________________
_____________/\\\//\////\\\___\/\\\_____________\/\\\___________________________
_____________/\\\______\//\\\__\/\\\\\\\\\\\_____\/\\\\\\\\\\\__________________
_____________\//\\\______/\\\___\/\\\///////______\/\\\///////__________________
_______________\///\\\\/\\\\/____\/\\\_____________\/\\\________________________
__________________\////\\\//______\/\\\_____________\/\\\_______________________
______________________\///\\\\\\___\/\\\_____________\/\\\______________________
_________________________\//////____\///______________\///______________________

                            Welcom to QuickFF
   a Python package to quickly derive force fields from ab initio input data

                                 Written by
     Louis Vanduyfhuys(1)*, Steven Vandenbrande(1) and Toon Verstraelen(1)

         (1) Center for Molecular Modeling, Ghent University Belgium.
                   * mailto: Louis.Vanduyfhuys@UGent.be


 USER               louis
 MACHINE            Linux molmod91 4.2.0-42-generic #49-Ubuntu SMP Tue Jun 28 
 MACHINE            21:26:26 UTC 2016 x86_64
 TIME               2016-11-05 14:18:00.154809
 QUICKFF VERSION    2.1.3
 PYTHON VERSION     2.7.10 (default, Oct 14 2015, 16:09:02) [GCC 5.2.1 20151010]
 NUMPY VERSION      1.8.2
 SCIPY VERSION      0.14.1
 MATPLOTLIB VERSION 1.4.2
 CURRENT DIR        /home/louis/build/quickff/doc
 COMMAND LINE       /home/louis/.local/bin/qff.py --ffatypes=low --suffix=_noei 
 COMMAND LINE       /home/louis/build/quickff/share/systems/benzene/
 COMMAND LINE       gaussian.fchk

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 SETT   log_level                       medium
 SETT   log_file                        None
 SETT   fn_yaff                         pars_yaff_noei.txt
 SETT   fn_sys                          system_noei.chk
 SETT   plot_traj                       False
 SETT   xyz_traj                        False
 SETT   fn_traj                         None
 SETT   program_mode                    DeriveNonDiagFF
 SETT   scoop                           False
 SETT   only_traj                       PT_ALL
 SETT   ffatypes                        low
 SETT   ei                              None
 SETT   vdw                             None
 SETT   covres                          None
 SETT   do_bonds                        True
 SETT   do_bends                        True
 SETT   do_diheds                       True
 SETT   do_oops                         True
 SETT   do_cross                        True
 SETT   do_squarebend                   True
 SETT   do_bendcharm                    True
 SETT   do_sqoopdist_to_oopdist         True

 QFF    Reading input
 QFF    Initializing Second order taylor reference for ai
 QFF    Initializing program

 VAL    Initializing valence force field
 VAL    Added 12 Harmonic bond terms
 VAL    Added 18 Harmonic bend terms
 VAL    Added 24 Cosine dihedral terms
 VAL    Added 6 Harmonic and 0 SquareHarmonic out-of-plane distance terms

 QFF    Initializing strain

 EQSET  Resetting system coordinates to ab initio ref
 EQSET  Setting rest values to AI equilibrium values for tasks EQ_RV
 EQSET  Averaging force field parameters over master and slaves

 PTGEN  Resetting system coordinates to ab initio ref
 PTGEN  Constructing trajectories

 PTEST  Resetting system coordinates to ab initio ref
 PTEST  Estimating FF parameters from perturbation trajectories

 PTPOST Averaging force field parameters over master and slaves

 VAL    Resetting system coordinates to ab initio ref
 VAL    Added 18 cross terms for angle patterns

 HCEST  Resetting system coordinates to ab initio ref
 HCEST  Estimating force constants from Hessian cost for tasks HC_FC_DIAG HC_FC_
 HCEST  CROSS

 PTEST  Resetting system coordinates to ab initio ref
 PTEST  Estimating FF parameters from perturbation trajectories with valence 
 PTEST  reference

 PROGRA Averaging force field parameters over master and slaves

 HCEST  Resetting system coordinates to ab initio ref
 HCEST  Estimating force constants from Hessian cost for tasks HC_FC_DIAG HC_FC_
 HCEST  CROSS


        BondHarm/C.C (kjmol/A^2  A)                                             
            fc =  3975 ± .000    rv = 1.394 ± .000

        BondHarm/C.H (kjmol/A^2  A)                                             
            fc =  3385 ± .000    rv = 1.084 ± .000

        BendAHarm/C.C.C (kjmol/rad^2  deg)                                      
            fc = 617.4 ± .000    rv = 119.9 ± .000

        BendAHarm/C.C.H (kjmol/rad^2  deg)                                      
            fc = 291.1 ± .000    rv = 120.0 ± .000

        Torsion/C.C.C.C (au  kjmol  deg)                                        
            fc = 32.0 ± .00    rv = .000 ± 0.0    m = 2

        Torsion/C.C.C.H (au  kjmol  deg)                                        
            fc = 31.9 ± 0.0    rv = .000 ± 0.0    m = 2

        Torsion/H.C.C.H (au  kjmol  deg)                                        
            fc = 12.9 ± 0.0    rv = .000 ± 0.0    m = 2

        Oopdist/C.C.H.C (kjmol/A^2  A)                                          
            fc = 274.7 ± .000    rv = .0000 ± .000

        Cross/C.C.C/b0a (kjmol/(A*rad)  A  deg)                                 
            fc = 9.48 ± .0    rv0 = 1.39 ± 0.0    rv0 =  120 ± 0.0

        Cross/C.C.C/b1a (kjmol/(A*rad)  A  deg)                                 
            fc = 9.60 ± .0    rv0 = 1.39 ± 0.0    rv0 =  120 ± 0.0

        Cross/C.C.C/bb (kjmol/A^2  A  A)                                        
            fc =  595 ± .0    rv0 = 1.39 ± 0.0    rv0 = 1.39 ± 0.0

        Cross/C.C.H/b0a (kjmol/(A*rad)  A  deg)                                 
            fc = 63.1 ± .0    rv0 = 1.39 ± .00    rv0 =  120 ± .00

        Cross/C.C.H/b1a (kjmol/(A*rad)  A  deg)                                 
            fc =  144 ± .0    rv0 = 1.08 ± 0.0    rv0 =  120 ± .00

        Cross/C.C.H/bb (kjmol/A^2  A  A)                                        
            fc =  120 ± .0    rv0 = 1.39 ± .00    rv0 = 1.08 ± 0.0

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


 TIMING Initializing                    0:00:00.545500
 TIMING Equil Set RV                    0:00:00.002024
 TIMING PT Generate                     0:00:19.002353
 TIMING PT Estimate                     0:00:00.069211
 TIMING PT Post process                 0:00:00.001777
 TIMING HC Estimate FC                  0:00:00.284861
 TIMING PT plot energy                  0:00:00.000008
 TIMING PT dump XYZ                     0:00:00.000004

__/\\\__________________________________________________________________/\\\____
  \ \\\                                                                 \ \\\
   \ \\\     End of file. Thanks for using QuickFF! Come back soon!!     \ \\\
____\///__________________________________________________________________\///__
</pre></div>
</div>
<p>The logger will dump to following information to the screen (or a file if the
<em class="xref std std-option">--logfile</em> option was used):</p>
<ul>
<li><dl class="first docutils">
<dt>Machine environment:</dt>
<dd><p class="first last">This section contains some general information about the machine environment
on which you ran the quickff job. It contains the user name, machine info,
starting time of job, Python version, Numpy version, Scipy versoin,
Matplotlib version, current directory and the command used
to envoke quickff.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Routine sequence:</dt>
<dd><p class="first last">Every task that is performed will be shown in the log output. For example,
the line <tt class="docutils literal"><span class="pre">PTGEN</span>&nbsp; <span class="pre">Constructing</span> <span class="pre">trajectories</span></tt> indicates that QuickFF is
busy constructing the perturbation trajectories. As a second example, the
line <tt class="docutils literal"><span class="pre">HCEST</span>&nbsp; <span class="pre">Estimating</span> <span class="pre">force</span> <span class="pre">constants</span> <span class="pre">from</span> <span class="pre">Hessian</span> <span class="pre">cost</span> <span class="pre">for</span> <span class="pre">tasks</span>
<span class="pre">HC_FC_DIAG</span> <span class="pre">HC_FC_CROSS</span></tt> indicates QuickFF is estimating force constants by
means of a least-square fit of the FF Hessian to the AI Hessian for each
term for which the task <cite>HC_FC_DIAG</cite> and <cite>HC_FC_CROSS</cite> was selected.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Final force field parameters:</dt>
<dd><p class="first last">The final FF parameters are shown at the end of the log output.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Timings:</dt>
<dd><p class="first last">Finally, a summary of the timings for several steps during run of the
program is provided.</p>
</dd>
</dl>
</li>
</ul>
<p>The force field parameters were also written to the Yaff parameters file
<cite>pars_cov.txt</cite>:</p>
<div class="highlight-text"><div class="highlight"><pre># BONDHARM
#---------
BONDHARM:UNIT  K kjmol/A**2
BONDHARM:UNIT  R0 A

BONDHARM:PARS         C         H  3.3852893947e+03  1.0844123950e+00
BONDHARM:PARS         C         C  3.9753852432e+03  1.3946491693e+00


# BENDAHARM
#----------
BENDAHARM:UNIT  K kjmol/rad**2
BENDAHARM:UNIT  THETA0 deg

BENDAHARM:PARS         C         C         H  2.9110664537e+02  1.2000492188e+02
BENDAHARM:PARS         C         C         C  6.1741724407e+02  1.1999871731e+02


# TORSION
#--------
TORSION:UNIT  A kjmol
TORSION:UNIT  PHI0 deg

TORSION:PARS         C         C         C         H  2 3.1976601203e+01  0.0000000000e+00
TORSION:PARS         H         C         C         H  2 1.2959200863e+01  0.0000000000e+00
TORSION:PARS         C         C         C         C  2 3.2099295991e+01  0.0000000000e+00


# OOPDIST
#--------
OOPDIST:UNIT  K kjmol/A**2
OOPDIST:UNIT  D0 A

OOPDIST:PARS         C         C         H         C  2.7473873774e+02  0.0000000000e+00


# Cross
#------
Cross:UNIT  KSS kjmol/angstrom**2
Cross:UNIT  KBS0 kjmol/(angstrom*rad)
Cross:UNIT  KBS1 kjmol/(angstrom*rad)
Cross:UNIT  R0 angstrom
Cross:UNIT  R1 angstrom
Cross:UNIT  THETA0 deg

Cross:PARS         C         C         H   1.2082812869e+02   6.3132531185e+01   1.4430463043e+02  1.3946595447e+00  1.0844161352e+00  1.2000342749e+02
Cross:PARS         C         C         C   5.9512368110e+02   9.4838480861e+00   9.6008754077e+00  1.3946595447e+00  1.3946595447e+00  1.2000554725e+02
</pre></div>
</div>
</div>
<div class="section" id="force-field-with-electrostatics">
<h2>Force field with electrostatics<a class="headerlink" href="#force-field-with-electrostatics" title="Permalink to this headline">¶</a></h2>
<ul>
<li><dl class="first docutils">
<dt>Generating Yaff input</dt>
<dd><p class="first">First we need to generate the Yaff input file for the electrostatic
contribution to the force field. This is done using the script
<a class="reference internal" href="rg_scripts.html#seclab-rg-scripts-inputei"><em>qff_input-ei.py</em></a>. For this tutorial,
we will convert the charges given in the dataset <cite>/wpart/he/charges</cite> of the
file <cite>gaussian_wpart.h5</cite> for the atoms in gaussian.fchk with atom types
according to the level <cite>medium</cite> and use Gaussian charge distributions:</p>
<div class="highlight-python"><div class="highlight"><pre>qff-input-ei.py --ffatypes=low --gaussian gaussian.fchk gaussian_wpart.h5 wpart/he
</pre></div>
</div>
<p>This command dumped the following output to the screen, indicating wheter or
not the atom types are well chosen from the point of view of electrostatics
(see second remark in <a class="reference internal" href="ug_inputei.html#seclab-ug-tools-inputei"><em>qff-input-ei.py</em></a>):</p>
<div class="highlight-text"><div class="highlight"><pre>Traceback (most recent call last):
  File &quot;/home/louis/.local/bin/qff-input-ei.py&quot;, line 146, in &lt;module&gt;
    main()
  File &quot;/home/louis/.local/bin/qff-input-ei.py&quot;, line 103, in main
    guess_ffatypes(system, options.ffatypes)
  File &quot;/home/louis/.local/lib/python2.7/site-packages/quickff/tools.py&quot;, line 216, in guess_ffatypes
    if settings.ffatypes == &#39;low&#39;:
AttributeError: &#39;str&#39; object has no attribute &#39;ffatypes&#39;
</pre></div>
</div>
<p>Furthermore, the following Yaff parameter (<cite>pars_ei_wpart_he.txt</cite>) file was written:</p>
<div class="last highlight-text"><div class="highlight"><pre>#Fixed charges
#---------------

FIXQ:UNIT Q0 e
FIXQ:UNIT P e
FIXQ:UNIT R angstrom
FIXQ:SCALE 1 1.0
FIXQ:SCALE 2 1.0
FIXQ:SCALE 3 1.0
FIXQ:DIELECTRIC 1.0

# Atomic parameters
# ----------------------------------------------------
# KEY        label  Q_0A              R_A
# ----------------------------------------------------
FIXQ:ATOM        H  0.0442214368  0.7309000000
FIXQ:ATOM        C -0.0441535372  1.1646000000
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Constructing the covalent contribution</dt>
<dd><p class="first">Now, we generate a covalent force field on top of the previously derived
electrostatic contribution using the qff.py script:</p>
<div class="highlight-python"><div class="highlight"><pre>qff.py --ffatype=low --ei=pars_ei_wpart_he.txt gaussian.fchk
</pre></div>
</div>
<p>The logging output for this job is:</p>
<div class="highlight-text"><div class="highlight"><pre>________________/\\\_________/\\\\\\\\\\\\\\\__/\\\\\\\\\\\\\\\_________________
______________/\\\\/\\\\_____\/\\\///////////__\/\\\///////////_________________
_____________/\\\//\////\\\___\/\\\_____________\/\\\___________________________
_____________/\\\______\//\\\__\/\\\\\\\\\\\_____\/\\\\\\\\\\\__________________
_____________\//\\\______/\\\___\/\\\///////______\/\\\///////__________________
_______________\///\\\\/\\\\/____\/\\\_____________\/\\\________________________
__________________\////\\\//______\/\\\_____________\/\\\_______________________
______________________\///\\\\\\___\/\\\_____________\/\\\______________________
_________________________\//////____\///______________\///______________________

                            Welcom to QuickFF
   a Python package to quickly derive force fields from ab initio input data

                                 Written by
     Louis Vanduyfhuys(1)*, Steven Vandenbrande(1) and Toon Verstraelen(1)

         (1) Center for Molecular Modeling, Ghent University Belgium.
                   * mailto: Louis.Vanduyfhuys@UGent.be


 USER               louis
 MACHINE            Linux molmod91 4.2.0-42-generic #49-Ubuntu SMP Tue Jun 28 
 MACHINE            21:26:26 UTC 2016 x86_64
 TIME               2016-11-05 14:18:10.385429
 QUICKFF VERSION    2.1.3
 PYTHON VERSION     2.7.10 (default, Oct 14 2015, 16:09:02) [GCC 5.2.1 20151010]
 NUMPY VERSION      1.8.2
 SCIPY VERSION      0.14.1
 MATPLOTLIB VERSION 1.4.2
 CURRENT DIR        /home/louis/build/quickff/doc
 COMMAND LINE       /home/louis/.local/bin/qff.py --ffatypes=low --suffix=_ei 
 COMMAND LINE       --ei=pars_ei_wpart_he.txt /home/louis/build/quickff/share/
 COMMAND LINE       systems/benzene/gaussian.fchk

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 SETT   log_level                       medium
 SETT   log_file                        None
 SETT   fn_yaff                         pars_yaff_ei.txt
 SETT   fn_sys                          system_ei.chk
 SETT   plot_traj                       False
 SETT   xyz_traj                        False
 SETT   fn_traj                         None
 SETT   program_mode                    DeriveNonDiagFF
 SETT   scoop                           False
 SETT   only_traj                       PT_ALL
 SETT   ffatypes                        low
 SETT   ei                              pars_ei_wpart_he.txt
 SETT   vdw                             None
 SETT   covres                          None
 SETT   do_bonds                        True
 SETT   do_bends                        True
 SETT   do_diheds                       True
 SETT   do_oops                         True
 SETT   do_cross                        True
 SETT   do_squarebend                   True
 SETT   do_bendcharm                    True
 SETT   do_sqoopdist_to_oopdist         True

 QFF    Reading input
 QFF    Initializing Second order taylor reference for ai
 QFF    Initializing program
Traceback (most recent call last):
  File &quot;/home/louis/.local/bin/qff.py&quot;, line 255, in &lt;module&gt;
    main()
  File &quot;/home/louis/.local/bin/qff.py&quot;, line 245, in main
    program = mode(system, ai, settings)
  File &quot;/home/louis/.local/lib/python2.7/site-packages/quickff/program.py&quot;, line 88, in __init__
    if system.cell.nvecs&gt;0:
AttributeError: &#39;yaff.pes.ext.Cell&#39; object has no attribute &#39;nvecs&#39;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


 TIMING Initializing                    0:00:00.042264

__/\\\__________________________________________________________________/\\\____
  \ \\\                                                                 \ \\\
   \ \\\     End of file. Thanks for using QuickFF! Come back soon!!     \ \\\
____\///__________________________________________________________________\///__
</pre></div>
</div>
<p>An extra line appeared in the beginning of the log output, i.e.
<tt class="docutils literal"><span class="pre">QFF</span>&nbsp;&nbsp;&nbsp; <span class="pre">Initializing</span> <span class="pre">Yaff</span> <span class="pre">force</span> <span class="pre">field</span> <span class="pre">reference</span> <span class="pre">for</span> <span class="pre">EI</span></tt>. This indicates
that an extra reference instance was created to represent the EI
contribution to the force field. Furthermore, the covalent parameters are
almost identical compared to the FF without electrostatics. This is indeed
what we expect due to the charges being so small.</p>
<p>The force field parameters were also written to the Yaff parameters file
<cite>pars_cov.txt</cite>:</p>
<div class="last highlight-text"><div class="highlight"><pre># BONDHARM
#---------
BONDHARM:UNIT  K kjmol/A**2
BONDHARM:UNIT  R0 A

BONDHARM:PARS         C         H  3.3854697508e+03  1.0847809292e+00
BONDHARM:PARS         C         C  3.9756331395e+03  1.3945718546e+00


# BENDAHARM
#----------
BENDAHARM:UNIT  K kjmol/rad**2
BENDAHARM:UNIT  THETA0 deg

BENDAHARM:PARS         C         C         H  2.9134031202e+02  1.2002064559e+02
BENDAHARM:PARS         C         C         C  6.1714249916e+02  1.1999667296e+02


# TORSION
#--------
TORSION:UNIT  A kjmol
TORSION:UNIT  PHI0 deg

TORSION:PARS         C         C         C         H  2 3.2004758267e+01  0.0000000000e+00
TORSION:PARS         H         C         C         H  2 1.3054873038e+01  0.0000000000e+00
TORSION:PARS         C         C         C         C  2 3.2117594950e+01  0.0000000000e+00


# OOPDIST
#--------
OOPDIST:UNIT  K kjmol/A**2
OOPDIST:UNIT  D0 A

OOPDIST:PARS         C         C         H         C  2.7301527890e+02  0.0000000000e+00


# Cross
#------
Cross:UNIT  KSS kjmol/angstrom**2
Cross:UNIT  KBS0 kjmol/(angstrom*rad)
Cross:UNIT  KBS1 kjmol/(angstrom*rad)
Cross:UNIT  R0 angstrom
Cross:UNIT  R1 angstrom
Cross:UNIT  THETA0 deg

Cross:PARS         C         C         H   1.2110928987e+02   6.3136672055e+01   1.4432714887e+02  1.3945221314e+00  1.0847777454e+00  1.2000548104e+02
Cross:PARS         C         C         C   5.9502002103e+02   9.4378387841e+00   9.5548638703e+00  1.3945221314e+00  1.3945221314e+00  1.2000973701e+02
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorial 1 - Benzene</a><ul>
<li><a class="reference internal" href="#covalent-force-field-without-non-bonding-terms">Covalent force field without non-bonding terms</a></li>
<li><a class="reference internal" href="#force-field-with-electrostatics">Force field with electrostatics</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ug_inputei.html"
                        title="previous chapter">3. Generating Yaff parameter file for the electrostatic contribution</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tu_water.html"
                        title="next chapter">Tutorial 2 - Water</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/tu_benzene.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tu_water.html" title="Tutorial 2 - Water"
             >next</a> |</li>
        <li class="right" >
          <a href="ug_inputei.html" title="3. Generating Yaff parameter file for the electrostatic contribution"
             >previous</a> |</li>
        <li><a href="index.html">QuickFF 2.1.3 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2016, Louis Vanduyfhuys.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>1. Running QuickFF using qff.py &#8212; QuickFF 2.1.3 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.1.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2. Importing QuickFF as a library" href="ug_lib.html" />
    <link rel="prev" title="1. Dependencies" href="ig.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ug_lib.html" title="2. Importing QuickFF as a library"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ig.html" title="1. Dependencies"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">QuickFF 2.1.3 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="running-quickff-using-qff-py">
<span id="seclab-ug-script"></span><h1>1. Running QuickFF using qff.py<a class="headerlink" href="#running-quickff-using-qff-py" title="Permalink to this headline">¶</a></h1>
<p>The most straightforward use of QuickFF is by means of a single command using
the <a class="reference internal" href="trash/rg_scripts.html#seclab-rg-scripts-qff"><span class="std std-ref">qff.py</span></a> script. The basic usage of this script
is as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">qff</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="n">options</span><span class="p">]</span> <span class="n">fns</span>
</pre></div>
</div>
<p>In the sections below, both the input files and the optional arguments are
discussed in detail. The description below is further illustrated with examples
in the <a class="reference internal" href="index.html#seclab-tutorials"><span class="std std-ref">tutorials</span></a>.</p>
<div class="section" id="mandatory-input-files">
<span id="seclab-inputfiles"></span><h2>1.1. Mandatory input files<a class="headerlink" href="#mandatory-input-files" title="Permalink to this headline">¶</a></h2>
<p>The script requires input files describing the system and reference
data. These files are provided to the program by means of the mandatory
arguments <cite>fns</cite> which should be the names of the files in question. If multiple
files, information in later files overwrites information from earlier files. The
following list enumerates all possible formats of these input files:</p>
<ul>
<li><p class="first"><strong>Gaussian formatted checkpoint file</strong> (file.fchk):</p>
<blockquote>
<div><p>a file generated using the
<a class="reference external" href="http://www.gaussian.com/g_tech/g_ur/u_formchk.htm">formchk</a> utility on a
checkpoint file from a Gaussian
<a class="reference external" href="http://www.gaussian.com/g_tech/g_ur/k_freq.htm">freq</a> job. The atomic
numbers, equilibrium geometry and equilibrium Hessian are extracted from
this file.</p>
</div></blockquote>
</li>
<li><p class="first"><strong>vasprun file</strong> (vasprun.xml):</p>
<blockquote>
<div><p>an <a class="reference external" href="https://www.w3.org/TR/REC-xml">XML</a> file generated by VASP during a
frequency calculation.</p>
</div></blockquote>
</li>
<li><p class="first"><strong>MolMod checkpoint file</strong> (file.chk)</p>
<blockquote>
<div><p>a file generated the <cite>molmod.io.chk.dump</cite> method from
<a class="reference external" href="http://molmod.github.com/molmod/">MolMod</a>. This file contains arrays
representing data stored in a computer-friendly format. Each array is stored
in the following format:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">tag</span>                                     <span class="n">kind</span><span class="o">=</span><span class="n">dtype</span> <span class="n">shape</span>
<span class="n">datanumber1</span>       <span class="n">datanumber2</span>       <span class="n">datanumber3</span>       <span class="n">datanumber4</span>
<span class="n">datanumber5</span>       <span class="n">datanumber6</span>       <span class="n">datanumber7</span>       <span class="n">datanumber8</span>
<span class="o">...</span>
</pre></div>
</div>
<p>QuickFF will recognize and read arrays with the following tags: <em>energy</em>,
<em>grad(ient)</em>, <em>hess(ian)</em>, <em>pos</em> (or <em>coords</em>), <em>rvecs</em> (or <em>cell</em>),
<em>bonds</em>, <em>ffatypes</em> and <em>ffatype_ids</em></p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="optional-input-files">
<h2>1.2. Optional input files<a class="headerlink" href="#optional-input-files" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><dl class="first docutils">
<dt>Electrostatic contribution (<code class="xref std std-option docutils literal"><span class="pre">--ei=EI</span></code>):</dt>
<dd>The user can define the electrostatic contribution of the force field using
the option <code class="xref std std-option docutils literal"><span class="pre">--ei=EI</span></code>. EI should be the file name of a Yaff parameter
file containing the electrostatic contribution.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Van der Waals contribution (<code class="xref std std-option docutils literal"><span class="pre">--vdw=VDW</span></code>):</dt>
<dd>The user can define the van der Waals contribution of the force field using
the option <code class="xref std std-option docutils literal"><span class="pre">--vdw=VDW</span></code>. VDW should be the file name of a Yaff
parameter file containing the van der Waals contribution.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Residual covalent contribution (<code class="xref std std-option docutils literal"><span class="pre">--covres=COVRES</span></code>):</dt>
<dd>The user can define an <cite>a priori</cite> defined contribution to the covalent
force field (and build a quickff force field on top of it) using the option
<code class="xref std std-option docutils literal"><span class="pre">--covres=COVRES</span></code>. QuickFF will not neglect terms already present
in the residual contribution, instead it will add an extra term for it.
COVRES should be the file name of a Yaff parameter file containing the
residual terms.</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="automatic-estimation-of-atom-types">
<span id="seclab-ug-atype-estimator"></span><h2>1.3. Automatic estimation of atom types<a class="headerlink" href="#automatic-estimation-of-atom-types" title="Permalink to this headline">¶</a></h2>
<p>The optional argument <code class="xref std std-option docutils literal"><span class="pre">--fflevel=LEVEL</span></code> will trigger the automatic
assignation of atom types to every atom in the system. There are four possible
levels of assignation:</p>
<blockquote>
<div><ul class="simple">
<li><em>low</em>: atom type is based on atom number</li>
<li><em>medium</em>: atom type is based on atom number and number of neighbors.</li>
<li><em>high</em>: atom type is based on atom number, number of neighbors and the atom number of those neighbors.</li>
<li><em>highest</em>: every single atom is given a unique atom type based on its index in the system.</li>
</ul>
</div></blockquote>
<p>The levels <cite>medium</cite> and <cite>high</cite> are the most usefull, <cite>medium</cite> will result in
higher transferability of the force field parameters, while <cite>high</cite> will
result in higher accuracy. The levels <cite>low</cite> and <cite>highest</cite> are mostly usefull
for debugging purposes. The automatic assignation for the levels <cite>medium</cite>
and <cite>high</cite> is illustrated for three different molecules in the figures
below. If the level <cite>medium</cite> is chosen, atom type strings will be of the
form <em>EN</em> in which <em>E</em> is the element and <em>N</em> is the number of neighbors.
When choosing atom types according to the level <cite>high</cite>, atom type strings
will be of the form <em>ENs</em> in which <em>E</em> is the element, <em>N</em> is the number
of neighbors and <em>s</em> is a string describing the neighbors. If the atom has
only 1 neighbor, then <em>s</em> is equal <em>_e</em> with <em>e</em> the element of the
neighbor. If the atom under consideration has 2 neighbors, then <em>s</em> is equal
to <em>_ee</em> in which the first and second <em>e</em> represent the element of the
first and second neighbor respectively. If the atom has more than 2
neighbors, then <em>s</em> will contain a substring <em>_en</em> for every neighboring
atom. In this substring, <em>e</em> represents the neighbor element and <em>n</em> is the
number of neighbors of that particular neighbor element. Multiple instances of
this <em>_en</em> string are ordered according to atomic number.</p>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="_images/atypes_medium.png"><img alt="Medium-level atom types" src="_images/atypes_medium.png" style="width: 898.5px; height: 304.0px;" /></a>
<p class="caption"><span class="caption-text"><strong>Figure 1</strong>: Medium-level atom types</span></p>
</div>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="_images/atypes_high.png"><img alt="High-level atom types" src="_images/atypes_high.png" style="width: 943.0px; height: 310.0px;" /></a>
<p class="caption"><span class="caption-text"><strong>Figure 2</strong>: High-level atom types</span></p>
</div>
<p>By default, the automatic assignation is switched off and the atom types are
suposed to be defined in the <a class="reference internal" href="#seclab-inputfiles"><span class="std std-ref">input files</span></a>.</p>
</div>
<div class="section" id="miscellanous-options">
<h2>1.4. Miscellanous options<a class="headerlink" href="#miscellanous-options" title="Permalink to this headline">¶</a></h2>
<p>Through the use of the following options, the user can manipulate what QuickFF
will exactly do.</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>Program mode (<code class="xref std std-option docutils literal"><span class="pre">-m</span> <span class="pre">PROGRAM_MODE</span></code> or <code class="xref std std-option docutils literal"><span class="pre">--program-mode=PROGRAM_MODE</span></code>):</dt>
<dd>Specify the program mode which defines the set of instructions that will be
executed. Allowed strings are the names of the program classes defined in
the <a class="reference internal" href="trash/rg_module.html#seclab-rg-modules-program"><span class="std std-ref">program</span></a> module. Be carefull, these
names are case sensitive. By default, the program <cite>DeriveNonDiagFF</cite> will be
used.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Trajectory storing/loading (<code class="xref std std-option docutils literal"><span class="pre">--fn-traj=FN_TRAJ</span></code>):</dt>
<dd>Depending if the given option argument corresponds to an existing file or
not, this option will load/save perturbation trajectories to/from a cPickled
file.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Construct specific trajectories (<code class="xref std std-option docutils literal"><span class="pre">--only-traj=ONLY_TRAJ</span></code>):</dt>
<dd>Construct the perturbation trajectory only for the terms with the given
basenames. This options is only applied in the MakeTrajectories program.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Output file suffix (<code class="xref std std-option docutils literal"><span class="pre">--suffix=SUFFIX</span></code>):</dt>
<dd>Suffix that will be added to all output files. By default, no suffix is
added.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Plot energy (<code class="xref std std-option docutils literal"><span class="pre">-e</span></code> or <code class="xref std std-option docutils literal"><span class="pre">--ener-traj</span></code>):</dt>
<dd>Plot the various energy contributions along the perturbation trajectories
to. By default, energy plotting is switched off.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Dump trajectories in XYZ format (<code class="xref std std-option docutils literal"><span class="pre">-x</span></code> or <code class="xref std std-option docutils literal"><span class="pre">--xyz-traj</span></code>):</dt>
<dd>Dump the perturbation trajectories in XYZ format. By default, trajectory
dumping is switched off.</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="output">
<h2>1.5. Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<p>During the derivation of the force field, QuickFF will dump some usefull
information to the screen including machine information, system information,
model information, the force field parameters after the perturbation step and
the final force field parameters. Additionally, three output files are
generated:</p>
<ul>
<li><p class="first">system.chk:</p>
<blockquote>
<div><p>A MolMod checkpoint file containing all system information. This file can be
used to start new QuickFF calculations or to perform force field simulations
using <a class="reference external" href="http://molmod.github.io/yaff/">Yaff</a> together with the file
pars_yaff.txt.</p>
</div></blockquote>
</li>
<li><p class="first">pars_yaff.txt:</p>
<blockquote>
<div><p>A formatted text file defining the final force field. This file can be read
by <a class="reference external" href="http://molmod.github.io/yaff/">Yaff</a> together with the file
system.chk, to perform force field simulations.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="logging">
<h2>1.6. Logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h2>
<p>These options control the logging of all the operations in QuickFF.</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>Silent mode (<code class="xref std std-option docutils literal"><span class="pre">-s</span></code> or <code class="xref std std-option docutils literal"><span class="pre">--silent</span></code>):</dt>
<dd>Swith of all logging completely, overwrites all other verbosity options. By
default, the silent mode is not activated.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Verbose mode (<code class="xref std std-option docutils literal"><span class="pre">-v</span></code> or <code class="xref std std-option docutils literal"><span class="pre">--verbose</span></code>):</dt>
<dd>Increases verbosity, is overwriten if <code class="xref std std-option docutils literal"><span class="pre">--silent</span></code> or
<code class="xref std std-option docutils literal"><span class="pre">--very-verbose</span></code> is switched on. By default, the verbose mode is
not activated.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Very verbose mode (<code class="xref std std-option docutils literal"><span class="pre">-V</span></code> or <code class="xref std std-option docutils literal"><span class="pre">--very-verbose</span></code>):</dt>
<dd>Increases verbosity to highest level, is overwriten if <code class="xref std std-option docutils literal"><span class="pre">--silent</span></code>
is switched on. This is mostly usefull for debugging purposes. By default,
the very verbose mode is not activated.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Pipe logging (<code class="xref std std-option docutils literal"><span class="pre">-l</span> <span class="pre">LOGFILE</span></code> or <code class="xref std std-option docutils literal"><span class="pre">--logfile=LOGFILE</span></code>):</dt>
<dd>Redirect logger output to a file with the name <cite>LOGFILE</cite>. By default, all
logging output is printed to the screen.</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="parallel-quickff">
<h2>1.7. Parallel QuickFF<a class="headerlink" href="#parallel-quickff" title="Permalink to this headline">¶</a></h2>
<p>If Scoop is installed, it is possible to run QuickFF on multiple cores of a
single node by using the optional argument <code class="xref std std-option docutils literal"><span class="pre">--scoop</span></code>. Only the
generation of the perturbation trajectories will be parallized as it is by far
the time determening step. The exact syntax to use QuickFF in parallel is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">scoop</span> <span class="o">-</span><span class="n">n</span> <span class="n">nproc</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">qff</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">scoop</span> <span class="p">[</span><span class="n">options</span><span class="p">]</span> <span class="n">fns</span>
</pre></div>
</div>
<p><em>nproc</em> is the number of processes that can be launched simultaneously. It is
important to note that one has to define the absolute path to the location of
the <cite>qff.py</cite> script. Finally, <cite>[options]</cite> and <cite>fns</cite> have the same meaning as
in the serial version.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1. Running QuickFF using qff.py</a><ul>
<li><a class="reference internal" href="#mandatory-input-files">1.1. Mandatory input files</a></li>
<li><a class="reference internal" href="#optional-input-files">1.2. Optional input files</a></li>
<li><a class="reference internal" href="#automatic-estimation-of-atom-types">1.3. Automatic estimation of atom types</a></li>
<li><a class="reference internal" href="#miscellanous-options">1.4. Miscellanous options</a></li>
<li><a class="reference internal" href="#output">1.5. Output</a></li>
<li><a class="reference internal" href="#logging">1.6. Logging</a></li>
<li><a class="reference internal" href="#parallel-quickff">1.7. Parallel QuickFF</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ig.html"
                        title="previous chapter">1. Dependencies</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ug_lib.html"
                        title="next chapter">2. Importing QuickFF as a library</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/ug_script.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ug_lib.html" title="2. Importing QuickFF as a library"
             >next</a> |</li>
        <li class="right" >
          <a href="ig.html" title="1. Dependencies"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">QuickFF 2.1.3 documentation</a> &#187;</li> 
      </ul>
    </div>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>